function FiletripBackendUploader(e,s,l){void 0!==e.ajax_url&&void 0!==s.channel_action_url?(this.actionName=s.channel_action_url,this.actionUrl=e.ajax_url+"?action="+this.actionName+"&security="+s.security+"&mediaID="+l.id,s.hasOwnProperty("is_subfolder")?this.actionUrl+="&subfolder="+s.is_subfolder:this.actionUrl+="&subfolder=false",0!=s.destination?this.actionUrl+="&target_folder="+window.btoa(s.destination):this.actionUrl+="&target_folder=false",0!=e.file_path&&(this.actionUrl+="&file_path="+e.file_path),s.actionUrl=this.actionUrl,this.sendFile=function(){return new Promise(function(t,i){var n=new EventSource(s.actionUrl);console.log(s.actionUrl);var a="#filetrip-upload-card-"+s.channel_key+l.id;n.addEventListener("message",function(e){var r=JSON.parse(e.data),i=jQuery(a).find(".filetrip-transfer-progress-fg"),t=jQuery(a).find(".filetrip-transfer-progress-label");i.width(r.percentage+"%"),t.text(r.percentage+"%"),jQuery(a).find("span.filetrip-transfer-progress-bytes").empty(),jQuery(a).find("span.filetrip-transfer-progress-bytes").append(bytesToSize(r.bytes)+" / "+l.file_size_friendly)},!1),n.addEventListener("error",function(e){var r='<a href="#" class="help_tip filetrip-help-pointer--icon" data-title="Help information" data-tip="['+e.data+']">?</a>';return jQuery(a).find("div.arfaly-drive-folder-loading").remove(),jQuery(a).find("span.filetrip-transfer-stage").append('<span class="stage failed active">Failed</span>'),jQuery(a).find(".stage-channel-icon").remove(),jQuery(a).find(".filetrip-transfer-progress-label").empty(),jQuery(a).find(".filetrip-transfer-progress-label").append(s.channel_icon),jQuery(a).find(".filetrip-transfer-completes").empty(),jQuery(a).find(".filetrip-transfer-completes").append(r),prepare_help_tip(jQuery),n.close(),i("FiletripBackendUploader: Error occured during file transfer")},!1),n.addEventListener("finished",function(e){e.type;var r=jQuery(a).find(".filetrip-transfer-progress-fg"),i=jQuery(a).find(".filetrip-transfer-progress-label");return r.width("100%"),i.text("100%"),jQuery(a).find("div.arfaly-drive-folder-loading").remove(),jQuery(a).find("span.filetrip-transfer-progress-bytes").empty(),jQuery(a).find("span.filetrip-transfer-progress-bytes").append(l.file_size_friendly+" / "+l.file_size_friendly),jQuery(a).find("span.filetrip-transfer-stage").append('<span class="stage succeed active filetrip-pull-left">Transferred</span>'),n.close(),t("success")},!1)})}):console.log("FiletripBackendUploader: Bad input")}