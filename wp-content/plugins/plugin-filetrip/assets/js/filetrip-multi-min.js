!function(x){x.fn.arfaly=function(e){var o,v=this,d=0,h={init:function(){h.config=x.extend({allowedFileSize:10485760,delay:5e3,multi:!0,request:[],url:"processMultipleUploads.php",dataType:"json",limitNumberofFiles:10,required:"false",formRequired:"false",enforceInfo:!1,enterTitleLbl:"Enter Upload Title",enterDescLbl:"Enter Upload Description",enterEmailLbl:"Enter your email",enterName:"Enter your name",label:"Allowed file types are gif, jpg, and png.",dropBox:{title:"Drop files here",height:100,fontSize:26},stableUploadLbl:"Everything going well so far!",uploadBtnLbl:"Upload",previewBtnLbl:"Preview",deleteBtnLbl:"Delete",deleteConfirmLbl:"Are you sure you want to delete the file?",backgroundIcon:"",chunkSize:5242880,maxUploadSize:8388608,chunkUpload:"true",debug:!1,dragDrop:!0,circularDropbox:!1,theme:"simplex",targetOutput:".output",type:"post",devDebug:!1,nonce:"",disablePreview:!1,disablePostProgressAnimation:!0,disableRemovingItems:!0,backgroundColor:"",logoColor:"rgb(150, 155, 255)",textColor:"#DADADA",borderColor:"#DADADA",labelColor:"rgb(90, 90, 90)",progressBarColor:"orange",action:"itech_arfalygold_submission",beforeSubmit:h.beforeSubmit,successfulUpload:h.successfulUpload,failedUpload:h.failedUpload,fileDeleted:h.fileDeleted},e),h.Setup(),x(h.config.targetOutput).hide()},Setup:function(){var e="",a="",i="",t="",s="",l="",n="";""!=h.config.backgroundIcon?(s="; background-image: url("+h.config.backgroundIcon+"); background-size: auto; background-position: 50% 20%; background-repeat: no-repeat;",n=";padding-top:"+h.config.dropBox.height+"px;"):l='<span id="arfaly-dropbox-icon-'+v.attr("id")+'" class="arfaly-showcase arfaly-icon arfaly-icon-cloud-storage" style="color:'+h.config.logoColor+'"></span>',h.config.multi&&(e="multiple"),"false"!=h.config.dragDrop&&(a="opacity:0;pointer-events: none;"),"true"==h.config.circularDropbox&&(i="arfaly-circular-dropbox"),"true"==h.config.formRequired&&(t="required");var r='<p class="arfaly-label" style="color:'+h.config.labelColor+'">'+h.config.label+"</p>",o='<input class="arfaly-multi-file-input" type="file" style="'+a+'" name="files[]" id="'+v.attr("id")+'-arfaly-files" '+e+" "+t+">",d='<div><div id="arfaly-filedrag-'+v.attr("id")+'" class="arfaly-filedrag '+i+'" style="color: '+h.config.textColor+";border: 5px dashed "+h.config.borderColor+";"+s+'">'+l+'<br/><div style="'+n+";font-size:"+h.config.dropBox.fontSize+'px" class="arfaly-box-label" id="box-label-'+v.attr("id")+'" >'+h.config.dropBox.title+"</div>"+o+"</div><br/>"+r+"</div>",c='<div id="'+v.attr("id")+'-ListItem" class="arfaly-multi-images"></div>';v.addClass("arfaly-multiple-upload"),"false"!=h.config.dragDrop?v.html(""+d+c):v.html(""+o+c)},bytesToSize:function(e){if(0==e)return"0 Bytes";var a=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,a),2)+" "+["Bytes","KB","MB","GB","TB"][a]},bytesToSizeClass:function(e){if(0==e)return"0 Bytes";var a=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return{size:Math.round(e/Math.pow(1024,a),2),type:["Bytes","KB","MB","GB","TB"][a]}},successfulUpload:function(e){},failedUpload:function(e){},fileDeleted:function(e){e.fileIdx;x.ajax({url:h.config.url,type:"POST",data:e,success:function(e){f(e)}})},beforeSubmit:function(e,a){var i=[],t=-1<navigator.userAgent.indexOf("Chrome"),s=-1<navigator.userAgent.indexOf("Safari");if(t&&s&&(s=!1),window.File&&window.FileReader&&window.FileList&&window.Blob){var l=e.size;switch(e.type){case"application/octet-stream":case"application/postscript":case"image/png":case"image/gif":case"image/jpeg":case"image/pjpeg":case"image/x-png":case"image/jpg":case"image/x-windows-bmp":case"image/bmp":case"image/tiff":case"image/x-tiff":case"image/svg+xml":o="arfaly-icon-photo";break;case"audio/aac":case"audio/mp4":case"audio/mp3":case"audio/ogg":case"audio/wav":case"audio/webm":o="arfaly-icon-music";break;case"video/mp4":case"video/ogg":case"video/mov":case"video/webm":case"video/avi":case"video/mkv":case"video/x-matroska":o="arfaly-icon-video2";break;case"application/x-zip-compressed":case"application/zip":case"application/x-rar-compressed":o="arfaly-icon-wallet";break;default:o="arfaly-icon-file"}return l>h.config.allowedFileSize?(i.status=!1,i.responseText=h.bytesToSize(l)+": The file size has exceeded the limit ("+h.config.allowedFileSize/1024/1024+"MB) !"):i.status=!0,i}return i.status=!1,i.responseText="Please upgrade your browser, because your current browser lacks some new features we need!",i},deleteItem:function(a){var e={"arfaly-id":v.attr("id"),command:"delete",arfalyfn:window.btoa(v.find("#"+a+"-fileName").text()),fileIndx:a,action:h.config.action,nonce:h.config.nonce,raqmkh:window.btoa(v.find("#file-"+a+"-"+v.attr("id")).val())};h.config.fileDeleted(e),x("#uploadItem-"+v.attr("id")+"-"+a).addClass("arfaly-animated bounceOutRight"),setTimeout(function(e){x("#uploadItem-"+v.attr("id")+"-"+a).remove()},600)},addFileItem:function(e,a){var i="",t="",s="";h.config.disablePreview||(t='<a rel="external" link="" id="preview-'+v.attr("id")+"-"+a+'" index="'+a+'" class="arfaly-preview"><span class="arfaly-icon arfaly-icon-earth" title="'+h.config.previewBtnLbl+'"></span></a>',s='<a class="arfaly-button arfaly-preview" index="'+a+'" >'+h.config.previewBtnLbl+"</a>"),"true"==h.config.required&&(i="required");var l='<input type="hidden" id="file-'+a+"-"+v.attr("id")+'" name="image-id[]" value="" />',n='<div id="arfaly-info-box-'+a+'" class="arfaly-info-box noselect"><div class="arfaly-info-p"><a class="arfaly-close" index="'+a+'"><span class="arfaly-info-close arfaly-icon arfaly-icon-delete"></span></a><div class="arfaly-info-internal-content">'+h.config.stableUploadLbl+'</div></div><div class="arfaly-pointer"></div></div>',r='<div class="clearfix arfaly-form-container"><input class="arfaly-input" type="text" name="arfaly-title" placeholder="'+h.config.enterTitleLbl+'" '+i+'/><br><textarea rows="2" class="arfaly-input" type="textarea" name="arfaly-desc" placeholder="'+h.config.enterDescLbl+'" '+i+'/><a class="arfaly-button arfaly-upload noselect" id="upload-button-'+a+"-"+v.attr("id")+'" index="'+a+'">'+h.config.uploadBtnLbl+'</a><a class="arfaly-button arfaly-delete noselect" id="'+a+'">'+h.config.deleteBtnLbl+"</a>"+s+"</div>";h.config.enforceInfo||(r="");var o='<a class="info-icon" index="'+a+'"><span class="arfaly-info-icon arfaly-icon arfaly-icon-info" ></span></a>',d='<a class="info-icon" index="'+a+'" title="Information Button"><span class="arfaly-icon arfaly-icon-info-large"></span></a>',c='<div id="uploadItem-'+v.attr("id")+"-"+a+'" class="arfaly-default-theme"><div class="arfaly-oval"><span class="arfaly-ready arfaly-icon arfaly-icon-plus" style="margin-top:35px;"></span><span class="arfaly-loading arfaly-icon arfaly-icon-spinner"></span><div id="mass-item-success-'+v.attr("id")+"-"+a+'" class="notification-oval"><ul class="arfaly-oval-list-info" id="mass-item-oval-info-'+v.attr("id")+"-"+a+'"><li class="arfaly-tick-text"  id="mass-item-success-text-'+v.attr("id")+"-"+a+'" style=";color:white;font-family:cursive;font-size:10px;color:white;list-style:none"></li></li></ul></div></div><div class="arfaly-list-div noselect" style="background-color:'+h.config.backgroundColor+'" >'+l+'<div><div class="arfaly-list-icon arfaly-left"><span id="mimePicture" class="arfaly-icon" style="font-size:40px"></span></div><div class="progress-container arfaly-right"><div id="progress-style-'+v.attr("id")+"-"+a+'" class="arfaly-meter '+h.config.progressBarColor+' arfaly-right"><span id="massUploadProgress-'+v.attr("id")+"-"+a+'" style="width: 0%;" class="arfaly-span-progress"></span></div><div id="'+a+'-fileName" class="arfaly-filename">'+e+'</div><div class="arfaly-list-menu arfaly-right"><ul><li><a class="arfaly-delete" id="'+a+'"><span class="arfaly-icon arfaly-icon-remove" title="'+h.config.deleteBtnLbl+'"></span></a>&nbsp;'+t+"</li></ul></div></div>"+o+"</div></div>"+r+"</div>",f='<div id="uploadItem-'+v.attr("id")+"-"+a+'" class="theme-1"><div class="arfaly-list-div noselect" style="background-color:'+h.config.backgroundColor+'">'+l+'<div><div class="progress-container arfaly-left"><div id="progress-style-'+v.attr("id")+"-"+a+'" class="arfaly-meter '+h.config.progressBarColor+' arfaly-left"><span id="massUploadProgress-'+v.attr("id")+"-"+a+'" style="width: 0%;" class="arfaly-span-progress"></span></div><div id="'+a+'-fileName" class="arfaly-filename">'+e+'</div></div><div class="arfaly-list-menu arfaly-right"><ul><li><a class="arfaly-delete" id="'+a+'"><span class="arfaly-icon arfaly-icon-remove" title="'+h.config.deleteBtnLbl+'"></span></a>&nbsp;'+t+"&nbsp;"+d+'<div class="arfaly-oval"><span class="arfaly-ready arfaly-icon arfaly-icon-plus"></span><span class="arfaly-loading arfaly-icon arfaly-icon-spinner" style="display: none;"></span><div id="mass-item-success-'+v.attr("id")+"-"+a+'" class="notification-oval" style="margin-top: 1px"><ul class="arfaly-oval-list-info" id="mass-item-oval-info-'+v.attr("id")+"-"+a+'"></ul></div></div></li></ul></div><div class="arfaly-list-icon arfaly-right"><span id="mimePicture" class="arfaly-icon" style="font-size:40px"></span></div></div></div>'+r+"</div>",u='<div id="uploadItem-'+v.attr("id")+"-"+a+'" class="theme-2"><div class="arfaly-list-div noselect" style="background-color:'+h.config.backgroundColor+'">'+l+'<div><div class="progress-container arfaly-left"><div id="progress-style-'+v.attr("id")+"-"+a+'" class="arfaly-meter '+h.config.progressBarColor+' arfaly-right"><span id="massUploadProgress-'+v.attr("id")+"-"+a+'" style="width: 0%;" class="arfaly-span-progress"></span></div><div id="'+a+'-fileName" class="arfaly-filename">'+e+'</div></div><div class="arfaly-list-menu arfaly-right"><ul><li><a class="arfaly-delete" id="'+a+'"><span class="arfaly-icon arfaly-icon-remove" title="'+h.config.deleteBtnLbl+'"></span></a>&nbsp;'+t+'<a class="info-icon" index="'+a+'" title="Information Button"><span class="arfaly-icon arfaly-icon-info-large"></span></a><div class="arfaly-oval"><span class="arfaly-ready arfaly-icon arfaly-icon-plus"></span><span class="arfaly-loading arfaly-icon arfaly-icon-spinner" style="display: none;"></span><div id="mass-item-success-'+v.attr("id")+"-"+a+'" class="notification-oval"><ul class="arfaly-oval-list-info" id="mass-item-oval-info-'+v.attr("id")+"-"+a+'"></ul></div></div></li></ul></div></div></div>'+r+"</div>",p=f;switch(h.config.theme){case"default":p=c;break;case"simplex":p=f;break;case"super-simplex":p=u;break;default:p=f}x("#"+v.attr("id")+"-ListItem").prepend(p),jQuery("body").prepend(n),h.config.enforceInfo||(x("#uploadItem-"+v.attr("id")+"-"+a).find(".arfaly-loading").css("display","block"),x("#uploadItem-"+v.attr("id")+"-"+a).find(".arfaly-ready").hide());var g,y,m=x("#uploadItem-"+v.attr("id")+"-"+a).find(".arfaly-oval").height()-x("#mass-item-success-"+v.attr("id")+"-"+a).height();x("#mass-item-success-"+v.attr("id")+"-"+a).css("margin-top",m/2+"px"),x("#uploadItem-"+v.attr("id")+"-"+a).find("a.arfaly-delete").click(function(){if(confirm(h.config.deleteConfirmLbl)){var e=x(this).attr("id");h.deleteItem(e)}}),g="default"==h.config.theme?(y=-35,25):(y=25,-100),x("#uploadItem-"+v.attr("id")+"-"+a).find("a.info-icon").click(function(e){x("#arfaly-info-box-"+a).css("top",e.pageY+y),x("#arfaly-info-box-"+a).css("left",e.pageX+g),x("#arfaly-info-box-"+a).slideDown()}),x("#arfaly-info-box-"+a).find("a.arfaly-close").click(function(e){var a=x(this).attr("index");x("#arfaly-info-box-"+a).slideUp()}),x(document).mouseup(function(e){var a=x(".arfaly-info-box");a.is(e.target)||0!==a.has(e.target).length||a.hide()}),x("#uploadItem-"+v.attr("id")+"-"+a).find("a.arfaly-preview").click(function(){var e=x(this).attr("index");""!=x("#preview-"+v.attr("id")+"-"+e).attr("link")&&window.open(x("#preview-"+v.attr("id")+"-"+e).attr("link"),"_blank")}),h.config.enforceInfo&&x("#uploadItem-"+v.attr("id")+"-"+a).find("a.arfaly-upload").click(function(){1==h.config.devDebug&&(console.log("Upload["+e+"] initiated by upload click"),console.log(h.config.request));var e=x(this).attr("index"),a=x("#uploadItem-"+v.attr("id")+"-"+e).find('input[name="arfaly-title"]'),i=x("#uploadItem-"+v.attr("id")+"-"+e).find('textarea[name="arfaly-desc"]'),t=a.val(),s=i.val();return void 0===t||""==t&&"true"==h.config.required?(x(a).focus(),!1):void 0===s||""==s&&"true"==h.config.required?(x(i).focus(),!1):void(null!=h.config.request[e]?(1==h.config.devDebug&&console.log("Upload["+e+"] started"),function(e,a,i){1==h.config.devDebug&&console.log("Request["+e+"] has started");"false"==h.config.chunkUpload?(h.config.request[e].open(h.config.type,h.config.url),h.config.request[e].send(h.config.request[e].cachedData),h.config.request[e]="invalid"):(x("#massUploadProgress-"+v.attr("id")+"-"+e).animate({width:"10%"},2e3),b(h.config.request[e],a,i))}(e,t,s)):1==h.config.devDebug&&console.log("arfaly.config.request["+e+"] already uploaded"))}),x("div.arfaly-list-div").click(function(e){e.preventDefault()})},tagItemSuccess:function(e,a,i){var t;x("#uploadItem-"+v.attr("id")+"-"+e).find(".arfaly-loading").hide(),1==h.config.devDebug&&console.log("Success tag = ["+a+"]"),a||x("#uploadItem-"+v.attr("id")+"-"+e).find(".arfaly-ready").hide(),a?(v.find("#"+v.attr("id")+"-arfaly-files").remove(),x("#uploadItem-"+v.attr("id")+"-"+e).find(".arfaly-preview").fadeIn(),x("#uploadItem-"+v.attr("id")+"-"+e).find(".arfaly-delete").fadeIn(),t='<li class="arfaly-icon arfaly-icon-tick center-icon" style="font-size:18px;color:white"></li>'):(t='<li class="arfaly-icon arfaly-icon-times center-icon" style="font-size:18px;color:white"></li>',c(e,i)),"true"!=x("#mass-item-success-"+v.attr("id")+"-"+e).attr("updated")&&(x("#mass-item-oval-info-"+v.attr("id")+"-"+e).prepend(t),x("#mass-item-success-"+v.attr("id")+"-"+e).attr("title",i),x("#uploadItem-"+v.attr("id")+"-"+e).attr("title",i),x("#mass-item-success-"+v.attr("id")+"-"+e).addClass("arfaly-animated "+(a?"flipNotificationSuccess":"flipNotificationError")),x("#mass-item-success-text-"+v.attr("id")+"-"+e).html(a?"Succeed":"Failed"),x("#mass-item-success-"+v.attr("id")+"-"+e).attr("updated","true"),f(i))},fileDragHover:function(e){e.stopPropagation(),e.preventDefault(),v.find("#arfaly-filedrag-"+v.attr("id")).removeClass("hover").addClass("dragover"==e.type?"hover":"")}};h.init();var a=v.find("#arfaly-filedrag-"+v.attr("id"));function c(e,a){x("#arfaly-info-box-"+e).find(".arfaly-info-internal-content").html(a)}function f(e){h.config.debug&&(x(h.config.targetOutput).is(":visible")?x(".output-list-"+v.attr("id")).append("<li>"+e+"</li>"):(x(h.config.targetOutput).html('<br><ol class="output-list-'+v.attr("id")+'"><li>'+e+"</li></ol>"),x(h.config.targetOutput).delay(300).slideDown()))}function i(e){var a=e;for(j=0;j<a.length;j++){if(d>=h.config.limitNumberofFiles)return f("You have exceed upload limit ("+d+") !"),!1;if(0!=a[j].length){var i=new FormData;i.append("SelectedFile",a[j]),i.append("action",h.config.action),i.append("closify-id",v.attr("closify-id")),i.append("closify-idx",v.attr("closify-idx")),i.append("fileIndx",d),i.append("nonce",h.config.nonce),h.addFileItem(a[j].name,d);var t=h.beforeSubmit(a[j],d);if(null==o?x("#uploadItem-"+v.attr("id")+"-"+d).find("#mimePicture").addClass("arfaly-icon-file"):x("#uploadItem-"+v.attr("id")+"-"+d).find("#mimePicture").addClass(o),1==t.status){var s=new XMLHttpRequest;h.config.request[d]=s,h.config.request[d].index=d,h.config.request[d].cachedData=i,h.config.request[d].onreadystatechange=function(){if(4==this.readyState){x("#uploadItem-"+v.attr("id")+"-"+this.index).find(".arfaly-loading").css("display","block"),x("#uploadItem-"+v.attr("id")+"-"+this.index).find(".arfaly-ready").hide();try{var a=JSON.parse(this.response);"true"==a.status?(a.attid&&v.find("#file-"+this.index+"-"+v.attr("id")).val(a.attid),h.tagItemSuccess(this.index,!0,a.data),null!=a.newFileName&&x("#"+this.index+"-fileName").text(a.newFileName),null!=a.fullPath&&x("#preview-"+v.attr("id")+"-"+this.index).attr("link",a.fullPath),1==h.config.disablePostProgressAnimation&&(1==h.config.disablePostProgressAnimation&&v.find("#progress-style-"+v.attr("id")+"-"+this.index).addClass("arfaly-nostripes"),v.find("#progress-style-"+v.attr("id")+"-"+this.index).addClass("arfaly-nostripes")),h.config.successfulUpload(a)):(h.tagItemSuccess(this.index,!1,a.error),h.config.failedUpload(a),c(this.index,a.error))}catch(e){a={status:"error",msg:"Response string format is not a valid JSON: ["+this.responseText+"]"},h.tagItemSuccess(this.index,!1,a.msg)}}},h.config.request[d].upload.index=d,h.config.request[d].upload.addEventListener("progress",function(e){var a=e.loaded/e.total*100,i=this.index;x("#massUploadProgress-"+v.attr("id")+"-"+this.index).css("width",a+"%"),100<=a&&!h.config.disableRemovingItems&&setTimeout(function(){h.deleteItem(i)},h.config.delay)},!1),h.config.enforceInfo||(h.config.request[d].open(h.config.type,h.config.url),h.config.request[d].send(i)),d++}else h.tagItemSuccess(d,!1,t.responseText),d++}}return 0}function t(e){var a,i,t,s,l=e;for(j=0;j<l.length;j++){if(d>=h.config.limitNumberofFiles)return f("You have exceed upload limit ("+d+") !"),!1;if(0!=l[j].length){h.addFileItem(l[j].name,d);var n=h.beforeSubmit(l[j],d);if(null==o?x("#uploadItem-"+v.attr("id")+"-"+d).find("#mimePicture").addClass("arfaly-icon-file"):x("#uploadItem-"+v.attr("id")+"-"+d).find("#mimePicture").addClass(o),1==n.status){var r=new XMLHttpRequest;h.config.request[d]=r,chunkSize=(a=l[j].size,t=void 0,i=h.bytesToSizeClass(a),t=h.config.maxUploadSize,s=Math.ceil(i.size/100),"bytes"==i.type?t=i.size/2:"KB"==i.type?(t=i.size/5,t*=1024):"MB"==i.type&&i.size<60?t=1024*(t=i.size/5/s)*1024:"GB"==i.type?t=h.config.maxUploadSize:"TB"==i.type&&(t=h.config.maxUploadSize),Math.ceil(t)),h.config.request[d]=r,h.config.request[d].file=l[j],h.config.request[d].file_size=l[j].size,h.config.request[d].chunk_size=chunkSize,h.config.request[d].range_start=0,h.config.request[d].range_end=h.config.request[d].chunk_size,h.config.request[d].is_paused=!1,h.config.request[d].chunks=Math.ceil(l[j].size/chunkSize),h.config.request[d].counter=1,"mozSlice"in l[j]?h.config.request[d].slice_method="mozSlice":"webkitSlice"in l[j]?h.config.request[d].slice_method="webkitSlice":h.config.request[d].slice_method="slice",h.config.request[d].index=d,h.config.request[d].onreadystatechange=function(){if(4==this.readyState){x("#uploadItem-"+v.attr("id")+"-"+this.index).find(".arfaly-loading").css("display","block"),x("#uploadItem-"+v.attr("id")+"-"+this.index).find(".arfaly-ready").hide();try{var e=this.counter/this.chunks*100,a=this.index;100<e&&(e=100),e<30?x("#massUploadProgress-"+v.attr("id")+"-"+this.index).animate({width:e+"%"},200):e<90?x("#massUploadProgress-"+v.attr("id")+"-"+this.index).animate({width:e+"%"},1e3):e<100?x("#massUploadProgress-"+v.attr("id")+"-"+this.index).animate({width:"95%"},3e3):x("#massUploadProgress-"+v.attr("id")+"-"+this.index).animate({width:"100%"},30),100<=e&&!h.config.disableRemovingItems&&setTimeout(function(e){h.deleteItem(a)},h.config.delay);var i=JSON.parse(this.response);if(this.range_end!==this.file_size&&"true"==i.status&&(this.range_start=this.range_end,this.range_end=this.range_start+this.chunk_size,!this.is_paused))return void b(this,"","");"true"!=i.status&&v.find("#progress-style-"+v.attr("id")+"-"+this.index).addClass("droply-nostripes"),this.range_end===this.file_size||"true"!=i.status?"true"==i.status?(i.attid&&v.find("#file-"+this.index+"-"+v.attr("id")).val(i.attid),h.tagItemSuccess(this.index,!0,i.data),null!=i.newFileName&&x("#"+this.index+"-fileName").text(i.newFileName),null!=i.fullPath&&x("#preview-"+v.attr("id")+"-"+this.index).attr("link",i.fullPath),1==h.config.disablePostProgressAnimation&&(1==h.config.disablePostProgressAnimation&&v.find("#progress-style-"+v.attr("id")+"-"+this.index).addClass("arfaly-nostripes"),v.find("#progress-style-"+v.attr("id")+"-"+this.index).addClass("arfaly-nostripes")),"true"==h.config.enforceInfo&&v.find("#upload-button-"+this.index+"-"+v.attr("id")).remove(),h.config.successfulUpload(i)):(h.tagItemSuccess(this.index,!1,i.error),h.config.failedUpload(i),c(this.index,i.error)):"false"==i.status&&(h.tagItemSuccess(this.index,!1,i.error),h.config.failedUpload(i),c(this.index,i.error))}catch(e){i={status:"error",msg:"Response string format is not a valid JSON: ["+this.responseText+"]"},h.tagItemSuccess(this.index,!1,i.msg)}}},h.config.request[d].upload.index=d,h.config.enforceInfo||(x("#massUploadProgress-"+v.attr("id")+"-"+d).animate({width:"1%"},2e3),b(h.config.request[d],"","")),d++}else h.tagItemSuccess(d,!1,n.responseText),d++}}return 0}function b(e,a,i){var t=e;t.timerLoop=setTimeout(function(){"true"!=h.config.enforceInfo?s(t,"",""):s(t,a,i)},20)}function s(e,a,i){e.range_end>e.file_size&&(e.range_end=e.file_size);var t=e.file[e.slice_method](e.range_start,e.range_end),s=new FormData;if(s.append("action",h.config.action),s.append("closify-id",v.attr("closify-id")),s.append("closify-idx",v.attr("closify-idx")),s.append("fileIndx",e.index),s.append("nonce",h.config.nonce),s.append("file-name",e.index+"_"+e.file.name),s.append("file-type",e.file.type),s.append("file-size",e.file.size),s.append("chunk-upload","true"),s.append("chunk",e.counter),s.append("chunks",e.chunks),s.append("file",t),"true"==h.config.enforceInfo){var l=x("#uploadItem-"+v.attr("id")+"-"+e.index).find('input[name="arfaly-title"]'),n=x("#uploadItem-"+v.attr("id")+"-"+e.index).find('textarea[name="arfaly-desc"]');a=l.val(),i=n.val();s.append("title",a),s.append("desc",i)}e.open(h.config.type,h.config.url,!0),e.overrideMimeType("application/octet-stream"),0!==e.range_start&&e.setRequestHeader("Content-Range","bytes "+e.range_start+"-"+e.range_end+"/"+e.file_size),e.send(s),e.counter++}a.on("dragover",h.fileDragHover),a.on("dragleave",h.fileDragHover),a.on("drop",function(e){e.stopPropagation(),e.preventDefault(),v.find("#arfaly-filedrag-"+v.attr("id")).removeClass("hover").addClass("");var a=e.target.files||e.originalEvent.dataTransfer.files;x("input[id="+v.attr("id")+"-arfaly-files]").removeAttr("required"),"true"==h.config.chunkUpload?t(a):i(a)}),a.css("display","block"),a.click(function(e){var a=e.target.id;a!="arfaly-dropbox-icon-"+v.attr("id")&&a!="arfaly-filedrag-"+v.attr("id")||x("input[id="+v.attr("id")+"-arfaly-files]").click()}),this.find("input[type=file]").change(function(){"true"==h.config.chunkUpload?t(this.files):i(this.files)})}}(jQuery);